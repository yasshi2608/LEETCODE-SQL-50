SELECT s.machine_id,
ROUND(AVG(e.timestamp - s.timestamp), 3) AS processing_time
FROM Activity s
JOIN Activity e
# MATCHING THE SAME MACHINE ID WITH ITS CORRESPONDING PROCESS_ID AND MAKING SURE ITS END TIME AND START TIME BELONGS TO SAME MACHINE AND PROCESS
ON s.machine_id = e.machine_id
AND s.process_id = e.process_id
AND s.activity_type = 'start'
AND e.activity_type = 'end'
GROUP BY s.machine_id;
